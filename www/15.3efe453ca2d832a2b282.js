(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"0XST":function(t,e,i){"use strict";i.r(e),i.d(e,"CompteUpdatePageModule",function(){return q});var o=i("ofXK"),n=i("3Pt+"),r=i("TEn/"),c=i("tyNb"),s=i("mrSG"),a=i("gcOT"),l=i("FQSO"),b=i("fXoL"),f=i("S64H"),u=i("E2f4"),d=i("uUxy"),m=i("IEis"),p=i("3iiJ"),h=i("3/Yl"),g=i("2MiI"),A=i("sYmb");function P(t,e){if(1&t&&(b.Ob(0),b.Qb(1,"small",13),b.uc(2),b.bc(3,"translate"),b.Pb(),b.Nb()),2&t){const t=e.$implicit;b.Ab(2),b.vc(b.cc(3,1,t))}}function v(t,e){if(1&t&&(b.Qb(0,"div"),b.sc(1,P,4,3,"ng-container",7),b.Pb()),2&t){const t=b.ac(4);b.Ab(1),b.fc("ngForOf",t.error.password.messages)}}function y(t,e){if(1&t&&(b.Qb(0,"ion-item"),b.Qb(1,"ion-label",11),b.uc(2),b.bc(3,"translate"),b.Pb(),b.Mb(4,"ion-input",12),b.sc(5,v,2,1,"div",5),b.Pb()),2&t){const t=b.ac().$implicit,e=b.ac(2);b.Ab(2),b.wc(" ",b.cc(3,5,t.label)," "),b.Ab(2),b.gc("name",t.field),b.fc("formControlName",t.field)("type",t.type),b.Ab(1),b.fc("ngIf",null==e.error?null:e.error.password)}}function _(t,e){if(1&t&&(b.Ob(0),b.Qb(1,"small",13),b.uc(2),b.bc(3,"translate"),b.Pb(),b.Nb()),2&t){const t=e.$implicit;b.Ab(2),b.vc(b.cc(3,1,t))}}function Q(t,e){if(1&t&&(b.Qb(0,"div"),b.sc(1,_,4,3,"ng-container",7),b.Pb()),2&t){const t=b.ac(4);b.Ab(1),b.fc("ngForOf",t.error.email.messages)}}function w(t,e){if(1&t&&(b.Qb(0,"ion-item"),b.Qb(1,"ion-label",11),b.uc(2),b.bc(3,"translate"),b.Pb(),b.Mb(4,"ion-input",12),b.sc(5,Q,2,1,"div",5),b.Pb()),2&t){const t=b.ac().$implicit,e=b.ac(2);b.Ab(2),b.wc(" ",b.cc(3,5,t.label)," "),b.Ab(2),b.gc("name",t.field),b.fc("formControlName",t.field)("type",t.type),b.Ab(1),b.fc("ngIf",null==e.error?null:e.error.email)}}function C(t,e){if(1&t&&(b.Qb(0,"ion-item"),b.Qb(1,"ion-label",11),b.uc(2),b.bc(3,"translate"),b.Pb(),b.Mb(4,"ion-datetime",14),b.Pb()),2&t){const t=b.ac().$implicit;b.Ab(2),b.wc(" ",b.cc(3,2,t.label)," "),b.Ab(2),b.fc("formControlName",t.field)}}function M(t,e){if(1&t&&(b.Qb(0,"div"),b.Qb(1,"ion-item",16),b.Mb(2,"ion-checkbox",17),b.Qb(3,"ion-label"),b.uc(4),b.Pb(),b.Pb(),b.Pb()),2&t){const t=e.$implicit,i=b.ac(2).$implicit;b.Ab(2),b.fc("formControlName",i.field)("required",i.is_required),b.Ab(2),b.wc(" ",t.label," ")}}function O(t,e){if(1&t&&(b.Qb(0,"div",15),b.sc(1,M,5,3,"div",7),b.Pb()),2&t){const t=b.ac().$implicit;b.Ab(1),b.fc("ngForOf",t.json_value)}}function F(t,e){if(1&t&&(b.Qb(0,"ion-col"),b.Qb(1,"ion-item",16),b.Qb(2,"ion-label"),b.uc(3),b.bc(4,"translate"),b.Pb(),b.Mb(5,"ion-radio",21),b.Pb(),b.Pb()),2&t){const t=e.$implicit;b.Ab(3),b.vc(b.cc(4,2,t.label)),b.Ab(2),b.fc("value",t.value)}}function I(t,e){if(1&t&&(b.Qb(0,"ion-grid"),b.Qb(1,"ion-radio-group",18),b.Qb(2,"ion-row",19),b.Qb(3,"ion-col"),b.Qb(4,"ion-item",20),b.Qb(5,"ion-label"),b.uc(6),b.bc(7,"translate"),b.Pb(),b.Pb(),b.Pb(),b.sc(8,F,6,4,"ion-col",7),b.Pb(),b.Pb(),b.Pb()),2&t){const t=b.ac().$implicit;b.Ab(1),b.fc("formControlName",t.field)("required",t.is_required),b.Ab(5),b.wc(" ",b.cc(7,4,t.label)," "),b.Ab(2),b.fc("ngForOf",t.json_value)}}function x(t,e){if(1&t&&(b.Qb(0,"div"),b.Qb(1,"ion-select-option",22),b.uc(2),b.Pb(),b.Pb()),2&t){const t=e.$implicit;b.Ab(1),b.fc("value",t.value),b.Ab(1),b.vc(t.label)}}function E(t,e){if(1&t&&(b.Qb(0,"ion-item"),b.Qb(1,"ion-label"),b.uc(2),b.bc(3,"translate"),b.Pb(),b.Qb(4,"ion-select",18),b.sc(5,x,3,2,"div",7),b.Pb(),b.Pb()),2&t){const t=b.ac().$implicit;b.Ab(2),b.wc(" ",b.cc(3,4,t.label),""),b.Ab(2),b.fc("formControlName",t.field)("required",t.is_required),b.Ab(1),b.fc("ngForOf",t.json_value)}}function k(t,e){if(1&t&&(b.Qb(0,"ion-list"),b.sc(1,y,6,7,"ion-item",5),b.sc(2,w,6,7,"ion-item",5),b.sc(3,C,5,4,"ion-item",5),b.sc(4,O,2,1,"div",10),b.sc(5,I,9,6,"ion-grid",5),b.sc(6,E,6,6,"ion-item",5),b.Pb()),2&t){const t=e.$implicit;b.Ab(1),b.fc("ngIf","text"==t.type||"password"==t.type||"tel"==t.type||"url"==t.type),b.Ab(1),b.fc("ngIf","email"==t.type),b.Ab(1),b.fc("ngIf","date"==t.type),b.Ab(1),b.fc("ngIf","checkbox"==t.type),b.Ab(1),b.fc("ngIf","radio"==t.type),b.Ab(1),b.fc("ngIf","select"==t.type)}}function L(t,e){if(1&t){const t=b.Rb();b.Qb(0,"div"),b.Qb(1,"form",6),b.Yb("ngSubmit",function(){return b.mc(t),b.ac().onSubmit()}),b.sc(2,k,7,6,"ion-list",7),b.Qb(3,"div",8),b.Qb(4,"ion-button",9),b.Yb("keyup.enter",function(){b.mc(t);const e=b.ac();return e.userprofileForm.valid&&!e.userprofileForm.pristine&&e.onSubmit()}),b.uc(5),b.bc(6,"translate"),b.Pb(),b.Pb(),b.Pb(),b.Pb()}if(2&t){const t=b.ac();b.Ab(1),b.fc("formGroup",t.userprofileForm),b.Ab(1),b.fc("ngForOf",t.forms),b.Ab(2),b.fc("disabled",t.userprofileForm.invalid||t.userprofileForm.pristine),b.Ab(1),b.vc(b.cc(6,4,"UPDATE"))}}const{Camera:U}=a.c,j=[{path:"",component:(()=>{class t{constructor(t,e,i,o,n,r,c,s,a){this._formBuilder=t,this.translate=e,this.actionSheetController=i,this.storage=o,this.api=n,this.alert=r,this.toast=c,this.route=s,this.load=a,this.base64Image=null,this.forms=[],this.item={},this.is_ready=!1}ngOnInit(){this.Storage(),this.loadData()}loadData(){return Object(s.a)(this,void 0,void 0,function*(){yield this.load.show(),this.api.getUpdateForms().then(t=>{this.userprofileForm=this.creatForm(t),this.load.hide(),this.is_ready=!0})})}creatForm(t){let e={};return t.map(t=>{if(t){const i=new l.a(t);this.forms.push(i),e[i.field]=i.is_required?"password"===i.type?new n.c({value:"",disabled:!0},[]):"email"===i.type?new n.c({value:i.default_value,disabled:!0},[]):new n.c(i.default_value,[n.p.required,n.p.pattern(i.pattern)]):new n.c(i.default_value,[])}}),this._formBuilder.group(e)}initCamera(){return Object(s.a)(this,void 0,void 0,function*(){const t=yield this.actionSheetController.create({header:this.translate.translate("CAMERA_CHOICE"),buttons:[{text:this.translate.translate("CAMERA_GALLERY"),icon:"image-outline",handler:()=>{this.takePicture(a.b.Photos)}},{text:this.translate.translate("CAMERA_CAMERA"),icon:"camera",handler:()=>{this.takePicture(a.b.Camera)}}]});yield t.present()})}takePicture(t){U.getPhoto({quality:90,source:t,resultType:a.a.DataUrl}).then(t=>{this.load.show(),this.api.uploadMedia(this.compte.id_customer,this.dataURLtoFile(t.dataUrl,"profil-"+Math.random().toString(36).substring(7)+this.compte.id_customer+".jpg")).then(e=>Object(s.a)(this,void 0,void 0,function*(){e&&(this.load.hide(),this.api.getUser().then(t=>{this.storage.setUser(t),this.notif_success()}),document.getElementById("profil").src=t.dataUrl,this.notif_success())}))},t=>{this.load.hide(),console.log(t)})}dataURLtoFile(t,e){let i=t.split(","),o=i[0].match(/:(.*?);/)[1],n=atob(i[1]),r=n.length,c=new Uint8Array(r);for(;r--;)c[r]=n.charCodeAt(r);return new File([c],e,{type:o})}Storage(){this.storage.user.subscribe(t=>{t&&(this.compte=t)}),this.storage.getUser().then(t=>{t&&(this.compte=t)})}onSubmit(){this.load.show();const t=this.userprofileForm.value;this.forms.forEach((e,i)=>{this.forms[i].value=t[e.field]}),this.api.updateCompte(this.forms).then(t=>{t?(this.load.hide(),this.storage.setUser(t),this.route.navigate(["tabs/compte"])):(this.load.hide(),this.notif_erreur())},t=>{this.error=t.error,this.load.hide(),this.notif_erreur()})}notif_erreur(){this.alert.alertConfig={header:"ERREUR",message:"ERREUR_GLOBAL",btn_ok:"OK"},this.alert.presentAlert()}notif_success(){this.toast.message="MODIF_IMAGE",this.toast.color="success",this.toast.AlertMessage()}}return t.\u0275fac=function(e){return new(e||t)(b.Lb(n.b),b.Lb(f.a),b.Lb(r.a),b.Lb(u.a),b.Lb(d.a),b.Lb(m.a),b.Lb(p.a),b.Lb(c.g),b.Lb(h.a))},t.\u0275cmp=b.Fb({type:t,selectors:[["app-compte-update"]],decls:7,vars:3,consts:[[3,"title"],[1,"profil-content"],[1,"iconBtn"],["color","light","name","camera-outline",1,"Icon",3,"click"],["id","profil","alt","",1,"profil",3,"src"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[4,"ngFor","ngForOf"],[1,"btn"],["type","submit","color","primary",3,"disabled","keyup.enter"],["class","check",4,"ngIf"],["position","stacked"],[3,"name","formControlName","type"],[1,"error-message"],["displayFormat","DD/MM/YYYY",3,"formControlName"],[1,"check"],["lines","none"],["mode","ios","slot","start",3,"formControlName","required"],[3,"formControlName","required"],[1,"ion-align-items-center","ion-justify-content-center"],["lines","none",1,"item-no-padding"],["slot","end",3,"value"],[3,"value"]],template:function(t,e){1&t&&(b.Mb(0,"app-header",0),b.Qb(1,"ion-content"),b.Qb(2,"div",1),b.Qb(3,"div",2),b.Qb(4,"ion-icon",3),b.Yb("click",function(){return e.initCamera()}),b.Pb(),b.Pb(),b.Mb(5,"img",4),b.Pb(),b.sc(6,L,7,6,"div",5),b.Pb()),2&t&&(b.fc("title","UPDATE"),b.Ab(5),b.fc("src",null==e.compte?null:e.compte.image,b.oc),b.Ab(1),b.fc("ngIf",e.is_ready))},directives:[g.a,r.p,r.u,o.l,n.q,n.l,n.g,o.k,r.h,r.z,r.x,r.y,r.w,r.eb,n.k,n.e,r.q,r.db,r.n,r.c,n.o,r.s,r.F,r.J,r.o,r.E,r.cb,r.L,r.M],pipes:[A.b],styles:[".div_item[_ngcontent-%COMP%]{width:100%}#label_modal[_ngcontent-%COMP%]{margin-top:-5px;color:#1b1919;font-weight:bolder;font-size:13px}#margin[_ngcontent-%COMP%]{margin-top:20px}.btn[_ngcontent-%COMP%]{margin-top:25px;text-align:center}.profil[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;object-fit:cover;object-position:center right}.profil-content[_ngcontent-%COMP%]{margin-top:10px;display:flex;width:100%;justify-content:center;align-items:center}.iconBtn[_ngcontent-%COMP%]{position:relative;border-radius:50%;width:30px;height:30px;bottom:-50px;right:-109px;background-color:var(--ion-color-primary)}.Icon[_ngcontent-%COMP%]{font-size:25px;width:100%}"]}),t})()}];let R=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[c.i.forChild(j)],c.i]}),t})();var S=i("iWjc");let q=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Jb({type:t}),t.\u0275inj=b.Ib({imports:[[o.c,n.h,r.W,n.n,R,S.a,A.a.forChild()]]}),t})()}}]);